<!DOCTYPE html>
<html lang="en">
<head>
  <title>Patient List</title>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script src="https://www.gstatic.com/firebasejs/5.5.8/firebase.js"></script>
  <script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyBHkznc6I46EAtk3L8bKm3h3t2Yx9NUyZI",
    authDomain: "phys-it.firebaseapp.com",
    databaseURL: "https://phys-it.firebaseio.com",
    projectId: "phys-it",
    storageBucket: "phys-it.appspot.com",
    messagingSenderId: "960737516865"
  };
  firebase.initializeApp(config);
</script>
<style>
#patients {
  width: 100%;
}

</style>
</head>
<body>
  <div id = "wrapper">
    <div id = "title">
      <h1>Patient List</h1>
    </div>
    <div id = "listcontainer">
      <table id="patients">
        <thead>
          <tr>
            <td>First Name</td>
            <td>Last Name</td>
            <td>Phone Number</td>
            <td>Appointment Time</td>
            <td>Action</td>
          </tr>
        </thead>
      </table>
    </div>
  </div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script>
      var physioUID;
      
      firebase.auth().onAuthStateChanged(function(user) {
      if (user) {
    // User is signed in.
            physioUID = user.uid;
            } else {
    // No user is signed in.
      alert("nope");
  }
          if (physioUID) {
  
            alert("[will remove] yourID: " + physioUID);
            } else {
      alert("nope");
  }
});
    
      //var name, email;
      if (user != null) {
      name = user.displayName;
      email = user.email;
      photoUrl = user.photoURL;
      emailVerified = user.emailVerified;
      uid = user.uid;  
      }
      var database = firebase.database();
      var patientList = firebase.database().ref().child('Patients');
      var count = 0;
      patientList.on('value', function(snap){
          if(snap.exists()){
              var content = '';
              snap.forEach(function(childNodes) {
                count++;
                var firstName = childNodes.val().FirstName;
                var lastName = childNodes.val().LastName;
                var phoneNumber = childNodes.val().PhoneNumber;
                var appointmentTime = childNodes.val().AppointmentTime;
                  content +='<tr>';
                  content += '<td>' + firstName + '</td>';
                  content += '<td>' + lastName + '</td>';
                  content += '<td>' + phoneNumber + '</td>';
                  content += '<td>' + appointmentTime + '</td>';
                  content += '<td><button><a href="patientprofile.html?patient='+ count +'">View</a></button></td>';
                  content += '</tr>';
              });
              $('#patients').append(content);
          }
      });
  </script>
</body>
</html>
